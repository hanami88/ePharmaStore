<main class="main" style="background-color: rgb(245, 245, 245)">
  <div class="header" style="margin-bottom: 0rem; width: 27rem ; height:6rem;">
    <a style="color: black;" href="/admin//quanlykhachhhang">
      <i
        class="fa-solid fa-arrow-left"
        style="font-size: 3.5rem; cursor: pointer"
      ></i>
    </a>
    <h2 style="margin-top: 2rem;">顧客詳細</h2>
  </div>
  <div class="hienthi-user">
    <div class="ctnthongtin-doimk">
      <div class="doimk">
        <div class="doimkcc" style="height:5rem">
          <a href="/admin/{{id}}/chitietkhachhang"><i
              class="fa-solid fa-arrow-left"
            ></i></a>
          <h1 class="title-doimk">パスワード変更</h1>
        </div>
      </div>
      <div class="thongtin-doimk">
        <form
          action="/admin/{{id}}/doimatkhau"
          method="post"
          class="container-doimk"
          data-user-id="{{id}}"
        >
          <div>
            アカウントのセキュリティ保護のため、パスワードは他人に共有しないでください。8〜16文字で設定してください。
          </div>

          <label for="mkm">新しいパスワード</label>
          <input
            type="password"
            name="mkm"
            id="mkm"
            class="mkm"
            placeholder="新しいパスワード"
          />

          <label for="nlmkm">新しいパスワード（確認用）</label>
          <input
            type="password"
            name="nlmkm"
            id="nlmkm"
            class="nlmkm"
            placeholder="新しいパスワード（確認用）"
          />

          <div id="error-message"></div>
          <button>変更する</button>
        </form>
      </div>
    </div>
  </div>
</main>

<script>
  const form = document.querySelector(".container-doimk"); const userId =
  form.dataset.userId; form.addEventListener("submit", async function (e) {
  e.preventDefault(); const newPassword =
  document.querySelector(".mkm").value.trim(); const confirmPassword =
  document.querySelector(".nlmkm").value.trim(); const errorBox =
  document.getElementById("error-message"); errorBox.textContent = "";
  errorBox.style.color = "red"; if (newPassword.length < 8) { // Mật khẩu phải
  có ít nhất 8 ký tự errorBox.textContent =
  "パスワードは8文字以上で入力してください。"; return; } if (newPassword !==
  confirmPassword) { // Mật khẩu mới không khớp errorBox.textContent =
  "パスワードが一致しません。"; return; } const res = await
  fetch(`/admin/${userId}/doimatkhau`, { method: "POST", headers: {
  "Content-Type": "application/json" }, body: JSON.stringify({ newPassword })
  }); const result = await res.json(); if (result.success) {
  window.location.href = `/admin/${userId}/chitietkhachhang`; } else { // Đã xảy
  ra lỗi. Vui lòng thử lại. errorBox.textContent =
  "エラーが発生しました。もう一度お試しください。"; } });
</script>